<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="
            http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

  <bean id="cdh511Hadoop" class="org.pentaho.hadoop.shim.cdh511.HadoopShim" scope="singleton"/>
  <service ref="cdh511Hadoop" interface="org.pentaho.hadoop.shim.spi.HadoopShim"/>

  <bean id="hbaseShim" class="org.pentaho.hbase.shim.common.CommonHBaseShim"/>
  <service ref="hbaseShim" interface="org.pentaho.hadoop.shim.spi.PentahoHadoopShim"/>

  <bean id="pigShim" class="org.pentaho.hadoop.shim.common.PigShimImpl">
    <property name="bundleContext" ref="blueprintBundleContext" />
  </bean>
  <service ref="pigShim" interface="org.pentaho.hadoop.shim.spi.PigShim"/>

  <bean id="sqoopShim" class="org.pentaho.hadoop.shim.common.CommonSqoopShim">
    <property name="bundleContext" ref="blueprintBundleContext" />
  </bean>
  <service ref="sqoopShim" interface="org.pentaho.hadoop.shim.spi.SqoopShim"/>

  <bean id="snappyShim" class="org.pentaho.hadoop.shim.common.SnappyShimImpl"/>
  <service ref="snappyShim" interface="org.pentaho.hadoop.shim.spi.SnappyShim"/>

  <bean id="oozieClientFactory" class="org.pentaho.hadoop.shim.common.delegating.DelegatingOozieClientFactory"/>
  <service ref="oozieClientFactory" interface="org.pentaho.oozie.shim.api.OozieClientFactory"/>

  <reference-list id="hadoopShims" interface="org.pentaho.hadoop.shim.spi.PentahoHadoopShim"
                  availability="optional"/>

  <bean id="cdh511HadoopConfiguration" class="org.pentaho.hadoop.shim.HadoopConfiguration">
    <argument value="cdh511" />
    <argument value="Cloudera CDH 5.11" />
    <argument ref="cdh511Hadoop"/>
    <!--<argument ref="hadoopConfigurationLocator"/>-->
    <argument>
      <list>
        <ref component-id="hbaseShim"/>
        <ref component-id="pigShim"/>
        <ref component-id="sqoopShim"/>
        <ref component-id="snappyShim"/>
        <ref component-id="oozieClientFactory"/>
      </list>
    </argument>
  </bean>

  <service ref="cdh511HadoopConfiguration" interface="org.pentaho.hadoop.shim.api.HadoopConfigurationInterface"/>

  <!--<bean id="hadoopConfigurationLocator" class="org.pentaho.hadoop.shim.HadoopConfigurationLocatorBundle">
    <argument>
      <list>
        <ref component-id="cdh511HadoopConfiguration"/>
      </list>
    </argument>
  </bean>
  <service ref="hadoopConfigurationLocator" interface="org.pentaho.hadoop.shim.spi.HadoopConfigurationProvider"/>-->

  <bean id="hasCdh511Configuration" class="org.pentaho.hadoop.shim.HasConfigurationImpl">
    <argument ref="cdh511HadoopConfiguration"/>
  </bean>

  <service ref="hasCdh511Configuration" interface="org.pentaho.hadoop.shim.api.HasConfiguration"/>
</blueprint>